---
name: weekly-report
description: retrospectiveとhandoverを集約し、週次レポートを生成する。Claude活用の成果と限界を組織報告用にまとめる。
---

# 週次レポート生成 (weekly-report)

## 概要
今週のretrospectiveとhandoverを全プロジェクトから集約し、
組織報告用の週次レポートを生成する。
「Claudeで何ができて、何ができなかったか」を中心にまとめる。

## 呼び出しタイミング
- 金曜日の午前中（週次報告の準備時）

## 実行手順

### 1. データ収集
以下のディレクトリから**前週金曜〜木曜**（7日間）のファイルを収集する:

- `~/.claude/retrospectives/*/` — 全プロジェクトのふりかえりレポート
- `~/.claude/handovers/*/` — 全プロジェクトの引き継ぎノート

集計対象期間の算出方法:
- **終了日**: 直近の木曜日（当日が金曜なら前日）
- **開始日**: 終了日の6日前（前週の金曜日）
- 例: 2/28（金）に実行 → 対象期間は 2/21（金）〜 2/27（木）

ファイル名の日付（YYYYMMDD or YYYY-MM-DD）から対象期間内のファイルを判定する。

### 2. 情報の抽出
収集したファイルから以下を抽出する:

#### retrospectiveから
- **Problem**: うまくいかなかったこと（全件）
- **Keep**: うまくいったこと（主要なもの）
- **Try**: 改善アクション（採用済みのもの）
- **数値サマリー**: タスク数、手戻り回数など
- **失敗パターン**: アンチパターン

#### handoverから
- **ハマりどころ**: 詰まったポイント
- **捨てた選択肢と理由**: 検討して不採用にしたもの

### 3. 分類・集約
抽出した問題を以下のカテゴリに分類する:

| カテゴリ | 説明 | 例 |
|---------|------|-----|
| 調査不足 | 既存コードやFE/E2Eの調査が足りなかった | 既存スクリプト未読で方針3回変更 |
| 外部ライブラリ | ライブラリの内部挙動や落とし穴を把握できなかった | chromedpコンテキスト管理、GORM内部挙動 |
| 仕様品質 | spec.mdの記述が曖昧・不足だった | コンテキストライフサイクル未定義 |
| 環境・データ | ローカル環境やテストデータの問題 | S3バケット未作成、テストデータ投入エラー |
| ケアレスミス | 単純な見落とし・誤り | チケット番号の取り違え |

**注意**: 分類は上記に限定しない。今週の内容に合わせて柔軟にカテゴリを追加・変更する。

### 4. レポート生成
以下のテンプレートに従って生成する。

### 5. 出力
- **出力先**: `~/.claude/weekly-reports/`
- **ファイル名**: `YYYY-MM-DD.md`（レポート生成日）
- ディレクトリが存在しない場合は作成する

### 6. ユーザーへの報告
生成したレポートをユーザーに提示し、追加・修正がないか確認する。
組織報告にそのまま使えるよう、過不足を調整する。

## 出力テンプレート

```markdown
# 週次レポート YYYY/MM/DD週

## 今週の活動サマリー

| 項目 | 値 |
|------|-----|
| 対応チケット数 | {N} |
| 完了タスク数 | {N} |
| 手戻り発生数 | {N} |
| レビュー指摘数 | {N} |

### 対応チケット一覧
| チケット | 内容 | フェーズ | 状況 |
|---------|------|---------|------|
| COMPASS-XXXX | {概要} | 設計 / 実装 | 完了 / 進行中 |

---

## Claudeでできなかったこと・限界を感じた点

### {カテゴリ1}: {サマリー}
- **事象**: {何が起きたか}
- **影響**: {どの程度の手戻り・追加作業が発生したか}
- **発見方法**: {誰が・何で気づいたか（ユーザー指摘 / code-reviewer / 動作テスト等）}

### {カテゴリ2}: {サマリー}
...

---

## ユーザー介入で軌道修正した場面
- {チケット名}: {ユーザーが何を指摘し、どう修正されたか}

---

## うまくいったこと（主要なもの）
- {K-X}: {概要}

---

## 改善アクション（今週採用したTry）
| Try | 内容 | 反映先 |
|-----|------|--------|
| {T-X} | {概要} | MEMORY.md / エージェント定義 / プロセス |

---

## 来週への申し送り
- {未完了タスクや継続課題}
```

## 注意事項
- 組織報告用なので**簡潔さを最優先**する。各項目は1〜2行で書く
- retrospectiveの詳細（事実・原因・影響の全文）はコピーしない。要約する
- 「できなかったこと」は事実ベースで書く。言い訳や弁解は不要
- 「ユーザー介入で軌道修正した場面」は重要。Claudeだけでは解決できなかった問題を可視化する
- 該当するデータがないセクションは「なし」と記載する
- retrospective/handoverが1件もない週は、その旨を記載してレポートは最小限にする
