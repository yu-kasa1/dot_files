# 開発ルール Laravel

## 単一責任の原則
- クラスとメソッドは1つの責任だけを持つ。
- 複雑なロジックは小さな専用メソッドに分割する。

## ファットモデル・スキニーコントローラ
- Controllerはリクエストの受付とレスポンスの返却に専念させる。
- ビジネスロジックはServiceクラスに実装する。
- DB操作はModelまたはRepositoryクラスで行う。(ControllerやServiceで直接行わない)
    - DB操作ロジックをModelに記載するかRepositoryに記載するかは既存実装を参考に判断する。
- FormRequestでバリデーションを行う。

## Eloquent
- N+1問題やオーバーフェッチを避けること。
- リレーション使用時は`with()`でEager Loadingを行うこと。
- `$fillable`を必ず定義すること。(`$guarded = []`は禁止)

## 翻訳・設定
- 表示文字列のハードコードを避け、`__()`ヘルパーを使用する。
- 翻訳ファイル(messages.php)内の定義は適切なPrefixで階層分けを行う。
- 環境依存の値は`.env`と`config/`で管理する。
- マジックナンバー、マジックストリングを避ける。

## Blade
- `{{ }}`（エスケープあり）をデフォルトで使用する
- `{!! !!}`は信頼できるデータのみに使用する
- テンプレート内にPHPロジックを書かない

## セキュリティ
- フォームには`@csrf`を必ず含めること。
- 生SQLを使用する場合は必ずバインディングを使用する。

## マイグレーション
- 一度実行されたマイグレーションは変更しない。
- 変更が必要な場合は新しいマイグレーションを作成する。
